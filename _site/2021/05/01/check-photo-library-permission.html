<!DOCTYPE html>
<html lang="en-US">
  <head>

    
      <script async src="https://www.googletagmanager.com/gtag/js?id=G-L7HJNDNMCD"></script>
      <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-L7HJNDNMCD');
      </script>
    
    <meta charset="UTF-8">

<!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Check Photo Library Permission in SwiftUI | Swift Code Show</title>
<meta name="generator" content="Jekyll v3.9.0" />
<meta property="og:title" content="Check Photo Library Permission in SwiftUI" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="You need check photo library permission everytime when app want to access user’s photo library. Otherwise nothing happen, and never ask again if user rejected at the first time. Therefore, if you found your app has been rejected from photo library access permission, you need ask user again manually. That’s why we have to check photo library permission manually and I write this article." />
<meta property="og:description" content="You need check photo library permission everytime when app want to access user’s photo library. Otherwise nothing happen, and never ask again if user rejected at the first time. Therefore, if you found your app has been rejected from photo library access permission, you need ask user again manually. That’s why we have to check photo library permission manually and I write this article." />
<link rel="canonical" href="https://swiftcodeshow.com/2021/05/01/check-photo-library-permission.html" />
<meta property="og:url" content="https://swiftcodeshow.com/2021/05/01/check-photo-library-permission.html" />
<meta property="og:site_name" content="Swift Code Show" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-05-01T00:00:00+08:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Check Photo Library Permission in SwiftUI" />
<script type="application/ld+json">
{"description":"You need check photo library permission everytime when app want to access user’s photo library. Otherwise nothing happen, and never ask again if user rejected at the first time. Therefore, if you found your app has been rejected from photo library access permission, you need ask user again manually. That’s why we have to check photo library permission manually and I write this article.","headline":"Check Photo Library Permission in SwiftUI","dateModified":"2021-05-01T00:00:00+08:00","datePublished":"2021-05-01T00:00:00+08:00","url":"https://swiftcodeshow.com/2021/05/01/check-photo-library-permission.html","mainEntityOfPage":{"@type":"WebPage","@id":"https://swiftcodeshow.com/2021/05/01/check-photo-library-permission.html"},"@type":"BlogPosting","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link rel="preload" href="https://fonts.googleapis.com/css?family=Open+Sans:400,700&display=swap" as="style" type="text/css" crossorigin>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="theme-color" content="#157878">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="stylesheet" href="/assets/css/style.css?v=84cd2af5631a16e088de3700a9ec4a8ab41d80a7">
  </head>
  <body>
    <header class="page-header" role="banner">
      <h1 class="project-name">Check Photo Library Permission in SwiftUI</h1>
      <nav style="margin-top: 2rem"><a href="/" class="btn">&lArr; Back to home</a></nav>
    </header>

    <main id="content" class="main-content" role="main">

      <p><b>Updated for Swift 5.4, and Xcode 12.5.</b></p>
      <p><a href="https://github.com/swiftcodeshow/CheckPhotoLibraryPermission">Checkout source code from Github</a></p>

      <h2 id="topics">Topics</h2>

<p>You need check photo library permission everytime when app want to access user’s photo library. Otherwise nothing happen, and never ask again if user rejected at the first time. Therefore, if you found your app has been rejected from photo library access permission, you need ask user again manually. That’s why we have to check photo library permission manually and I write this article.</p>

<h2 id="codes">Codes</h2>

<p><strong>First of all</strong> Add <em>Privacy - Photo Library Usage Description</em> to <em>Info.plist</em>.</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">import</span> <span class="kt">SwiftUI</span>
<span class="kd">import</span> <span class="kt">Photos</span>

<span class="kd">struct</span> <span class="kt">ContentView</span><span class="p">:</span> <span class="kt">View</span> <span class="p">{</span>
    
    <span class="kd">@State</span> <span class="k">var</span> <span class="nv">title</span> <span class="o">=</span> <span class="s">""</span>
    
    <span class="kd">@State</span> <span class="k">var</span> <span class="nv">message</span> <span class="o">=</span> <span class="s">""</span>
    
    <span class="k">var</span> <span class="nv">body</span><span class="p">:</span> <span class="kd">some</span> <span class="kt">View</span> <span class="p">{</span>
        
        <span class="kt">VStack</span> <span class="p">{</span>

            <span class="k">if</span> <span class="n">title</span> <span class="o">!=</span> <span class="s">""</span> <span class="p">{</span>
                
                <span class="kt">Text</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
                
                <span class="kt">Text</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
            <span class="p">}</span>
            
            <span class="kt">Button</span><span class="p">(</span><span class="s">"Check Photo Library Permission"</span><span class="p">)</span> <span class="p">{</span>
                
                <span class="k">let</span> <span class="nv">status</span> <span class="o">=</span> <span class="kt">PHPhotoLibrary</span><span class="o">.</span><span class="nf">authorizationStatus</span><span class="p">(</span><span class="nv">for</span><span class="p">:</span> <span class="o">.</span><span class="n">readWrite</span><span class="p">)</span>
                <span class="k">switch</span> <span class="n">status</span> <span class="p">{</span>
                <span class="k">case</span> <span class="o">.</span><span class="nv">limited</span><span class="p">:</span>
                    <span class="n">title</span> <span class="o">=</span> <span class="s">"Limited"</span>
                    <span class="n">message</span> <span class="o">=</span> <span class="s">"You can access user specified photos only"</span>
                <span class="k">case</span> <span class="o">.</span><span class="nv">authorized</span><span class="p">:</span>
                    <span class="n">title</span> <span class="o">=</span> <span class="s">"Authorized"</span>
                    <span class="n">message</span> <span class="o">=</span> <span class="s">"You can access all photos"</span>
                <span class="k">case</span> <span class="o">.</span><span class="nv">notDetermined</span><span class="p">:</span>
                    <span class="kt">PHPhotoLibrary</span><span class="o">.</span><span class="nf">requestAuthorization</span><span class="p">(</span><span class="nv">for</span><span class="p">:</span> <span class="o">.</span><span class="n">readWrite</span><span class="p">)</span> <span class="p">{</span> <span class="n">result</span> <span class="k">in</span>
                        <span class="k">switch</span> <span class="n">result</span> <span class="p">{</span>
                        <span class="k">case</span> <span class="o">.</span><span class="nv">authorized</span><span class="p">:</span>
                            <span class="n">title</span> <span class="o">=</span> <span class="s">"Authorized"</span>
                            <span class="n">message</span> <span class="o">=</span> <span class="s">"You can access all photos"</span>
                        <span class="k">case</span> <span class="o">.</span><span class="nv">limited</span><span class="p">:</span>
                            <span class="n">title</span> <span class="o">=</span> <span class="s">"Authorized"</span>
                            <span class="n">message</span> <span class="o">=</span> <span class="s">"You can access all photos"</span>
                        <span class="k">case</span> <span class="o">.</span><span class="nv">denied</span><span class="p">:</span>
                            <span class="n">title</span> <span class="o">=</span> <span class="s">"Denied"</span>
                            <span class="n">message</span> <span class="o">=</span> <span class="s">"You can not access anything, and you should guide user to settings here"</span>
                        <span class="k">case</span> <span class="o">.</span><span class="nv">restricted</span><span class="p">:</span>
                            <span class="nf">fatalError</span><span class="p">(</span><span class="s">"Should never be RESTRICT."</span><span class="p">)</span>
                        <span class="k">case</span> <span class="o">.</span><span class="nv">notDetermined</span><span class="p">:</span>
                            <span class="nf">fatalError</span><span class="p">(</span><span class="s">"Should never be NOT DETERMINED."</span><span class="p">)</span>
                        <span class="kd">@unknown</span> <span class="k">default</span><span class="p">:</span>
                            <span class="nf">fatalError</span><span class="p">(</span><span class="s">"Unknown status: </span><span class="se">\(</span><span class="n">result</span><span class="o">.</span><span class="n">rawValue</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
                        <span class="p">}</span>
                    <span class="p">}</span>
                <span class="k">case</span> <span class="o">.</span><span class="nv">denied</span><span class="p">:</span>
                    <span class="n">title</span> <span class="o">=</span> <span class="s">"Denied"</span>
                    <span class="n">message</span> <span class="o">=</span> <span class="s">"You can not access anything, and you should guide user to settings here"</span>
                <span class="k">case</span> <span class="o">.</span><span class="nv">restricted</span><span class="p">:</span>
                    <span class="n">title</span> <span class="o">=</span> <span class="s">"Restricted"</span>
                    <span class="n">message</span> <span class="o">=</span> <span class="s">"Forbidden by Parent strategy"</span>
                <span class="kd">@unknown</span> <span class="k">default</span><span class="p">:</span>
                    <span class="nf">fatalError</span><span class="p">(</span><span class="s">"Unknown status: </span><span class="se">\(</span><span class="n">status</span><span class="o">.</span><span class="n">rawValue</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="screenshots">Screenshots</h2>

<p><img src="/assets/2021-05-01-check-photo-library-permission.gif" alt="Check Photo Library Permission" /></p>

<h2 id="key-points">Key Points</h2>

<ol>
  <li>Import <strong>Photos</strong> module.</li>
  <li>Request permission when you found the authorization status is <strong>notDetermined</strong>.</li>
</ol>


      <footer class="site-footer">
        <span class="site-footer-credits">SwiftCodeShow &copy; 2021</span>
        <a href="#" style="float: right">Back to top</a>
      </footer>
    </main>
  </body>
</html>